{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.1",
  "parameters": {
    "clusterName": {
      "type": "string",
      "defaultValue": "AKS-TBLX",
      "metadata": {
        "description": "The name of the Managed Cluster resource."
      }
    },
    "location": {
      "type": "string",
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "The location of the Managed Cluster resource."
      }
    },
    "dnsPrefix": {
      "type": "string",
      "metadata": {
        "description": "Optional DNS prefix to use with hosted Kubernetes API server FQDN."
      }
    },
    "osDiskSizeGB": {
      "type": "int",
      "defaultValue": 5,
      "metadata": {
        "description": "Disk size (in GB) to provision for each of the agent pool nodes. This value ranges from 0 to 1023. Specifying 0 will apply the default disk size for that agentVMSize."
      },
      "minValue": 0,
      "maxValue": 1023
    },
    "agentCount": {
      "type": "int",
      "defaultValue": 3,
      "metadata": {
        "description": "The number of nodes for the cluster."
      },
      "minValue": 1,
      "maxValue": 50
    },
    "agentVMSize": {
      "type": "string",
      "defaultValue": "Standard_DS2_v2",
      "metadata": {
        "description": "The size of the Virtual Machine."
      }
    },
    "linuxAdminUsername": {
      "type": "string",
      "metadata": {
        "description": "User name for the Linux Virtual Machines."
      }
    },
    "sshRSAPublicKey": {
      "type": "string",
      "defaultValue": "\"MIIJKQIBAAKCAgEAwsD/hdKrWJg1MYfXuRYh5bHs2ZhiHSyNbKWk551DVHIk0cEVHBO9zuF7L+iKmPf3i20hYkKfXM/b/ol05xFJe/sLNbysvXV39areBJEdw/oHerlgCwFSCM3vGeEDxAZZpKnIl/VZ1iZHwbVY06Q5tjwLKMseECEw2TJCIo8OmiyfeqKuwdaa+UX9lORFn3j7a5ieWhkGWIiPHTrwQao+cgg8Oj0nlCOsRDQeHI7Fz1yO6ZV+V19NZiUxvziKhNCV4rVrqHO5ZIhfwIVv0ozcAL/Vx3jHUYHOtke1TxtwGrYZ/UdJ0YWY73LQiuoPs148XdyZfFasjzakXFz3yRzDf2b8QmbZHNCiI6TTssf9cPNIVxCNcE4ovabMY6xr4xbkoaLz+060VmAffCGI4mirAYxFlYKFqlx6laOh6FLG9YoIS7UZqlNi7ehijzeoHHEsSX4y2z+Rhiyy6wFlSSH7yFooIZ+s+HRnFqn7v8+qNwS0arBGdCvVd4UaFvaqO76FuQxx2PTz4jzMWYUI48neEnTlDM8+TjVsLZQMq64Kf+B29Z3qzys5wsBWLztuczupWV6feumQibYEMiRt2LGtSHSktsPd0l3iz/OtUOyAclqI4i7J+DiUYg/Ktjse+oheLaORu6qgKLsWWbweCSleJtxrV+vKXggzBJHSiz3vyy0CAwEAAQKCAgAJlKT9WFfFi/dR8HTUThpsykv0iGKLPN3YMm3iVwIw7UySZQU81FvKCZ2dxbrLu6cZ3Mx/oPdmAXO5Gdn+ZANRbhAnHJkC2PyFwVoar2jfczVa/DOVVwNKG5dfloow4n8WcqPDlfZNaqStCtbL0pBkPp/t6dAYywk0JhzKxm7ZdsiBp+8g6gXFrYPEB1bFeZYkvOVNWV3OjSk9LuES2eUohu8vjkKcLwUSdd3lWcCxasQ9CXWlprKQC9Req9Fkpz44YORi7Q55u5u6RNYzbWqFPuqtXWuwvsoEfZKVyavCJKMyqocfH4tefC92Jf2PvVsK4wdJ7pmekfmT8Z7e7eNQEy7UL0/YBXTazTzqkYdX8BvQPe9tgFuHSCXJEjVnwJ6op14AFw75VaiI5MKY2nkmjAmiAQrIdvyIOsZXxOh/bMAf8ChSJah6K5Dsu0J3uH6tc7MIAZ9Rur4sGPn5OFcEYLdHZZxsbYS0h1j19VVbvkhiGS5GXdkUMi76tvU7saqPBkKRyvijXp2Ygh/dqljrEBb0uHAhnhHNpfoQ55xZsxZoNk4QJ2BFJJ5CorAX2D1HcZsDaKR/0dGr4umpC/m1SCZol4X9Bm0stDhP5hzW8v8wonGwoh4bYtrjdYdETMxFwama1HRG3+ir1dEYa09e1klqoa95EzabnnYE1ZXFAQKCAQEA5V7MQCmVOY/6xtuLp9kRTdpOTVfsKeMlvXkk/KWCo3FnSrebsDIsmauxx7BQFfs3FpWNT/4AKTEOA9Oz7aJJpC+aXwItr0COMOa1tN0cuXPOcuCH+pW86s3cSc2B7cb8cyn7/3OA0lQet0HQVhnJ+dtyetbbt3hcSuuoHGzUvug0414Fr4P2fpfCa5WyAL5Lr3hfwiuNErqrO6citWUeoXOHZf5h6ub9zExME6PvE8K/l9unhZFElI0BtoWQGCLQSyD2DfxDYTfFuTg9ObVT2sgOR/Lx0BWsR9QL3u3reJZCHZpWUob2hHTz7L77y2cd0esX/SulGTEkBUjgCvknNQKCAQEA2V1aWS9D1ZJ07d9k3ez93QheYWiyh+wNxfwe7ODmpH1KYd8Jde18n43zOIlbSkT9gHjsCNwIEyDv26GJQi8gXU55acNz6IgGdnGpiTV7WnfZgW/jGTSw9Gdfda544uCSHffJIN+8uDemUPDHlygpaxNhiJ9GLogj3Iyxt05X1xlVFodvGWmzRCncXMFYW/neMeO35fBJ2qPfvg6YuBHmsLZOFR9eNX2bRllZ3oW1rYdXKk1GE/b5q9QdpLuAsDDNIt6IVrVduSiRbD4en1wvqdOYse5IzjuSxEoD5S+kp46LxEUsU7kC36OkLuZ/XBNzT7i2eZHMaaIMnOyA/ML7GQKCAQEAw19nHTQOTrSsSFxTbcpAqg7Maab9m4RG7khVT/pu92cuM3+H1qI2SULtMImm/cI43zzN3JgfbPbC2FGoTj7Q+VAu7sR9Q2z6cP7jQcaho/nXnRRR3wlSnLJy9E5fYLkA6duWMbYhwYYzj6c4nU5kMzZQIgAHsRSNkKeAT44H/QDvo8e/kgwWlygPS/J7Z5SwBSvEbTEJfi2Qk0Q/FUGnwKAWcbMnlp3hCvbmSkh16WAWMHTCEcx2HQ6qqdzEqzpkL8pIrAr3HcUS3zzfMduZLJ8BQxnWDYeYcqpU3jPMQa/Da1G+O5eIPbUc3Mik01HnHZphmZ1miLnJ09KKO+6UDQKCAQAtsZs5nl8DOauNCeY5ZQWk/opgrdLCEhR/J1YU895oe9I0Kt/hQ5BsNjoIC4/+V+x2onT0E9U6uDTUFew11pRWKRYK7sSiAF5jbdd2+aA5z3IQ7MVv2gzNBCIkKg5Nm2n8FMfaOk6A52n2H/fFRfMXCFb7kof9Zi8rwQPnBfgfRrsFZmkrjXXbAXXKpfZ+N1PHZxiUpOPRq5twZ78hCtpVEa3ucM6sLgCDVGs5BSDBHu9q/B2cOtIXlhq5M5WE9G1bRC6jE7NlJisT9ycW1xlJ+SpjVTVG7W0YCHszJcXWV3f4RZZg70a0XsE3/sqNP6WA/9KUUdsH5cIDBxDCkfaZAoIBAQCfZju8NNdu6c8IouBei9m/rPjcVRrtwfcqtYx7bThWzLGemwuU5E1NW3lkGf1p60VIduD/YkJmjhG8Vap3LDK3OSXtN8MJgTnxhAufksRDEhabKqQY/bHbMV8gOAr3+3fmSHrdY27RemOrnzMfOd78NdoFpGIQIEOxUArfOBi3q53wty9QU3pHYgIaD6TRSVBRSS+DLW4fPagwA6TunsD68epGh97lV0CH6vbI/VFhBZxu9xoMibSmaqnowqeRO/TD1Kutd/0fbzhJ2k/g5rR/qeuEyzLhtVAhkbJSS4kvV+YhaaAgbay/FORrgB7ZMHg2hV0TTYsDBg4zIb9+OXJO",
      "metadata": {
        "description": "Configure all linux machines with the SSH RSA public key string. Your key should include three parts, for example 'ssh-rsa AAAAB...snip...UcyupgH azureuser@linuxvm'"
      }
    },
    "servicePrincipalClientId": {
      "metadata": {
        "description": "Client ID (used by cloudprovider)"
      },
      "type": "securestring"
    },
    "servicePrincipalClientSecret": {
      "metadata": {
        "description": "The Service Principal Client Secret.",
        "defaultValue": "fkgluahgnoiervwbw gsgfgfdsg eegsag"
      },
      "type": "securestring"
    },
    "osType": {
      "type": "string",
      "defaultValue": "Linux",
      "allowedValues": [
        "Linux"
      ],
      "metadata": {
        "description": "The type of operating system."
      }
    }
  },
  "resources": [
    {
      "apiVersion": "2018-03-31",
      "type": "Microsoft.ContainerService/managedClusters",
      "location": "[parameters('location')]",
      "name": "[parameters('clusterName')]",
      "properties": {
        "dnsPrefix": "[parameters('dnsPrefix')]",
        "agentPoolProfiles": [
          {
            "name": "agentpool",
            "osDiskSizeGB": "[parameters('osDiskSizeGB')]",
            "count": "[parameters('agentCount')]",
            "vmSize": "[parameters('agentVMSize')]",
            "osType": "[parameters('osType')]",
            "storageProfile": "ManagedDisks"
          }
        ],
        "linuxProfile": {
          "adminUsername": "[parameters('linuxAdminUsername')]",
          "ssh": {
            "publicKeys": [
              {
                "keyData": "[parameters('sshRSAPublicKey')]"
              }
            ]
          }
        },
        "servicePrincipalProfile": {
          "clientId": "[parameters('servicePrincipalClientId')]",
          "Secret": "[parameters('servicePrincipalClientSecret')]"
        }
      }
    }
  ],
  "outputs": {
    "controlPlaneFQDN": {
      "type": "string",
      "value": "[reference(parameters('clusterName')).fqdn]"
    }
  }
}